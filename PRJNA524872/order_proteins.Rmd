---
title: "Order proteins for .faa files"
output: html_notebook
---
```{r}
library(Biostrings)
library("tidyr")
library("dplyr")
library("stringr")
```

LOADING .fna FILE AND EXTRACTING PROTEIN ID
```{r}
fna <- readDNAStringSet("cds_from_genomic.fna") %>% # extract .fna file (proteins' sequences)
  as.data.frame()
fna <- fna %>% mutate( # add column with protein_id
    protein_id = str_extract(rownames(fna), "(?<=protein_id=)[^]]+")
  )
fna <- fna[!is.na(fna$protein_id), ] # removes rows with no protein_id
```

LOADING .faa FILE TO REORDER
```{r}
faa <- readDNAStringSet("protein.faa")
faa_ids <- sub(" .*", "", names(faa))  # take only the protein_id
```

REORDERING .faa FILE FROM .fna FILE
```{r}
fna <- fna[fna$protein_id %in% faa_ids,] # select protein_id that are both in .faa and .fna
ordered_faa <- faa[fna$protein_id]
writeXStringSet(ordered_faa, "reordered.faa") # save the ordered .faa file
```






